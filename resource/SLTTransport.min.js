(function(c){var a=c.SALTR=c.SALTR||{};a.TransportEvent={COMPLETE:"COMPLETE",ERROR:"ERROR"};a.Transport=function(b){a.EventDispatcher.apply(this);var d=this;this._request=b;this._xhr=new XMLHttpRequest;!1 in this._xhr&&(this._xhr=new XDomainRequest);this._xhr.onload=function(){var c;if("JSON"==b.contentType)try{c=JSON.parse(d._xhr.responseText),d.dispatchEvent(a.TransportEvent.COMPLETE,c)}catch(e){d.dispatchEvent(a.TransportEvent.ERROR,"[JSONAsset] JSON parsing Error.")}};this._xhr.onerror=function(){d.dispatchEvent(a.TransportEvent.ERROR)}};
a.Transport.prototype=new a.EventDispatcher;a.Utils.extend(a.Transport.prototype,{load:function(){var b=this._request.url;this._request.method==a.Config.RequestMethod.GET?(this._request.data&&(b+="?"+this._request.data),this._xhr.open(this._request.method,"proxy.php?url="+encodeURIComponent(b),!0),this._xhr.send()):this._request.method==a.Config.RequestMethod.POST&&(this._xhr.open(this._request.method,b,!0),this._xhr.send(this._request.data?this._request.data:null))},close:function(){this._xhr.abort()}})})(window);
